<!DOCTYPE html>
<html>
<head>
    <style>
        :root { --neon: #39ff14; --bg: #000; }
        body { background: var(--bg); color: var(--neon); font-family: monospace; padding: 30px; }
        .nav { border-bottom: 2px solid var(--neon); padding-bottom: 15px; margin-bottom: 30px; display: flex; justify-content: space-between; }
        .app-item { border: 1px solid var(--neon); padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .btn { background: none; border: 1px solid var(--neon); color: var(--neon); padding: 8px 15px; cursor: pointer; font-family: inherit; }
        .btn:hover { background: var(--neon); color: var(--bg); }
    </style>
</head>
<body>
    <div class="nav">
        <h1>TOKO_SIMPUL > REPO_RAVIYANTO</h1>
        <button class="btn" onclick="window.location.href='dashboard.html'">KEMBALI</button>
    </div>
    <div id="display">Menghubungkan ke GitHub...</div>

    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script>
        let toko;
        new QWebChannel(qt.webChannelTransport, function(channel) {
            toko = channel.objects.tokoManager;
            muatToko();
        });

        function muatToko() {
            toko.dapatkan_daftar_remote(function(apps) {
                const container = document.getElementById('display');
                container.innerHTML = "";
                apps.forEach(app => {
                    toko.cek_terinstal(app, function(isInstalled) {
                        const div = document.createElement('div');
                        div.className = 'app-item';
                        let btnText = isInstalled ? "UNINSTALL" : "INSTALL";
                        let btnClass = isInstalled ? "btn btn-uninstall" : "btn";
                        div.innerHTML = `<span>${app.toUpperCase()}</span> 
                                         <button class="${btnClass}" onclick="aksi('${app}', '${isInstalled}')">${btnText}</button>`;
                        container.appendChild(div);
                    });
                });
            });
        }

        function aksi(nama, status) {
            if (status === "true") {
                if(confirm("Hapus " + nama + "?")) toko.hapus_app(nama);
            } else {
                toko.instal_app(nama);
                alert("Sedang mengunduh " + nama + " dari GitHub...");
            }
            setTimeout(muatToko, 2000);
        }
    </script>
</body>
</html>