<!DOCTYPE html>
<html>
<head>
    <style>
        :root { --neon: #39ff14; --bg: #000; }
        body { background: var(--bg); color: var(--neon); font-family: monospace; padding: 30px; margin: 0; }
        .nav { border-bottom: 2px solid var(--neon); padding-bottom: 15px; margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center; }
        .app-item { border: 1px solid var(--neon); padding: 20px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .btn { background: none; border: 1px solid var(--neon); color: var(--neon); padding: 10px; cursor: pointer; font-family: inherit; }
        .btn:hover { background: var(--neon); color: var(--bg); }
    </style>
</head>
<body>
    <div class="nav"><h1>TOKO_SIMPUL</h1><button class="btn" onclick="window.location.href='dashboard.html'">KEMBALI</button></div>
    <div id="display">Menghubungkan ke GitHub...</div>
    <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script>
        let toko;
        new QWebChannel(qt.webChannelTransport, function(channel) {
            toko = channel.objects.tokoManager;
            renderToko();
        });
        function renderToko() {
            toko.dapatkan_daftar_remote(function(apps) {
                const container = document.getElementById('display');
                container.innerHTML = "";
                apps.forEach(app => {
                    // FIX: Menggunakan penamaan fungsi yang konsisten dengan Python
                    const cekFunc = toko.cek_terinstal || toko.cekTerinstal;
                    cekFunc(app, function(isInstalled) {
                        const div = document.createElement('div');
                        div.className = 'app-item';
                        div.innerHTML = `<span>${app.toUpperCase()}</span> 
                                         <button class="btn" onclick="proses('${app}', ${isInstalled})">${isInstalled ? 'UNINSTALL' : 'INSTALL'}</button>`;
                        container.appendChild(div);
                    });
                });
            });
        }
        function proses(nama, isInstalled) {
            if (isInstalled) { if(confirm("Hapus?")) toko.hapus_app(nama); }
            else { toko.instal_app(nama); alert("Menginstal Aplikasi"); }
            setTimeout(renderToko, 2000);
        }
    </script>
</body>
</html>